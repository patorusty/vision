{"remainingRequest":"/Users/patorusty/dev/web/vision/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/patorusty/dev/web/vision/front/src/views/pages/Administracion/Companias/CodigoProductor/ModalCodigoProductor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/patorusty/dev/web/vision/front/src/views/pages/Administracion/Companias/CodigoProductor/ModalCodigoProductor.vue","mtime":1614543095826},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zLCBtYXBNdXRhdGlvbnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IHsgaGVscGVycyB9IGZyb20gIi4uLy4uLy4uLy4uLy4uL2hlbHBlcnMiOwppbXBvcnQgaHR0cCBmcm9tICIuLi8uLi8uLi8uLi8uLi9odHRwLXJlcXVlc3QiOwppbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gImRlYm91bmNlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBtaXhpbnM6IFtoZWxwZXJzXSwKICBkYXRhOiAoKSA9PiAoewogICAgcnVsZXM6IHsKICAgICAgcmVxdWlyZWQ6IHZhbHVlID0+ICEhdmFsdWUgfHwgIkVzdGUgY2FtcG8gb2JsaWdhdG9yaW8iCiAgICB9LAogICAgY3BVc2FkbzogZmFsc2UKICB9KSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoImNvZGlnb19wcm9kdWN0b3IiLCBbImNvZGlnb19wcm9kdWN0b3IiXSksCiAgICAuLi5tYXBTdGF0ZSgiY29tcGFuaWEiLCBbImNvbXBhbmlhIl0pLAogICAgLi4ubWFwU3RhdGUoInByb2R1Y3RvciIsIFsicHJvZHVjdG9yZXMiXSksCiAgICAuLi5tYXBTdGF0ZSgib3JnYW5pemFkb3IiLCBbIm9yZ2FuaXphZG9yZXMiXSksCiAgICAuLi5tYXBTdGF0ZSgiY29kaWdvX29yZ2FuaXphZG9yIiwgWyJjb2RpZ29fb3JnYW5pemFkb3JlcyJdKSwKICAgIC4uLm1hcFN0YXRlKCJtb2RhbCIsIFsibW9kYWwyIiwgImVkaWNpb24yIl0pCiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKCJjb2RpZ29fcHJvZHVjdG9yIiwgWwogICAgICAidXBkYXRlQ29kaWdvUHJvZHVjdG9yIiwKICAgICAgImNyZWF0ZUNvZGlnb1Byb2R1Y3RvciIKICAgIF0pLAogICAgLi4ubWFwTXV0YXRpb25zKCJtb2RhbCIsIFsiSElERV9NT0RBTDIiXSksCiAgICAuLi5tYXBNdXRhdGlvbnMoImNvZGlnb19wcm9kdWN0b3IiLCBbIlJFU0VUX0NPRElHT19QUk9EVUNUT1IiXSksCiAgICBhc3luYyBjcmVhdGUoKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoKSkgewogICAgICAgIHRoaXMuY29kaWdvX3Byb2R1Y3Rvci5jb21wYW5pYV9pZCA9IHRoaXMuY29tcGFuaWEuaWQ7CiAgICAgICAgY29uc3QgY3JlYXRlUmVzdWx0ID0gYXdhaXQgdGhpcy5jcmVhdGVDb2RpZ29Qcm9kdWN0b3IoCiAgICAgICAgICB0aGlzLmNvZGlnb19wcm9kdWN0b3IKICAgICAgICApOwogICAgICAgIGlmIChjcmVhdGVSZXN1bHQpIHsKICAgICAgICAgIHRoaXMuY2xvc2VNb2RhbCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFzeW5jIHVwZGF0ZSgpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuZm9ybS52YWxpZGF0ZSgpKSB7CiAgICAgICAgY29uc3QgdXBkYXRlUmVzdWx0ID0gYXdhaXQgdGhpcy51cGRhdGVDb2RpZ29Qcm9kdWN0b3IoCiAgICAgICAgICB0aGlzLmNvZGlnb19wcm9kdWN0b3IKICAgICAgICApOwogICAgICAgIGlmICh1cGRhdGVSZXN1bHQpIHsKICAgICAgICAgIHRoaXMuY2xvc2VNb2RhbCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNsb3NlTW9kYWwoKSB7CiAgICAgIHRoaXMuSElERV9NT0RBTDIoZmFsc2UpOwogICAgICB0aGlzLlJFU0VUX0NPRElHT19QUk9EVUNUT1IoKTsKICAgICAgdGhpcy4kcmVmcy5mb3JtLnJlc2V0VmFsaWRhdGlvbigpOwogICAgICB0aGlzLmNwVXNhZG8gPSBmYWxzZTsKICAgIH0sCiAgICBidXNjYXJDUDogZGVib3VuY2UoYXN5bmMgZnVuY3Rpb24oKSB7CiAgICAgIGlmICgKICAgICAgICB0aGlzLmNvZGlnb19wcm9kdWN0b3IuY29kaWdvX3Byb2R1Y3RvciAmJgogICAgICAgIHRoaXMuY29kaWdvX3Byb2R1Y3Rvci5jb2RpZ29fcHJvZHVjdG9yICE9CiAgICAgICAgICB0aGlzLmNvZGlnb19wcm9kdWN0b3IuY3BPcmlnaW5hbAogICAgICApIHsKICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgaHR0cC5wb3N0KCIvY29kaWdvX3Byb2R1Y3Rvci9idXNxdWVkYUNQIiwgewogICAgICAgICAgY29kaWdvX3Byb2R1Y3RvcjogdGhpcy5jb2RpZ29fcHJvZHVjdG9yLmNvZGlnb19wcm9kdWN0b3IsCiAgICAgICAgICBjb2RpZ29fb3JnYW5pemFkb3JfaWQ6IHRoaXMuY29kaWdvX3Byb2R1Y3Rvci5jb2RpZ29fb3JnYW5pemFkb3JfaWQsCiAgICAgICAgICBjb21wYW5pYV9pZDogdGhpcy5jb21wYW5pYS5pZAogICAgICAgIH0pOwogICAgICAgIHRoaXMuY3BVc2FkbyA9IHJlc3AuZGF0YS51c2FkbzsKICAgICAgfQogICAgfSwgNTAwKQogIH0sCiAgd2F0Y2g6IHsKICAgIG1vZGFsMigpIHsKICAgICAgaWYgKCF0aGlzLm1vZGFsMikgewogICAgICAgIHRoaXMuY2xvc2VNb2RhbCgpOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["ModalCodigoProductor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuFA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ModalCodigoProductor.vue","sourceRoot":"src/views/pages/Administracion/Companias/CodigoProductor","sourcesContent":["<template>\n  <v-card>\n    <v-card-title>\n      <span>Codigo Productor</span>\n    </v-card-title>\n    <v-card-text>\n      <v-container>\n        <v-form ref=\"form\">\n          <v-row>\n            <v-col>\n              <v-select\n                label=\"Seleccione Productor\"\n                v-model=\"codigo_productor.productor_id\"\n                :items=\"productores\"\n                :item-text=\"codigoText\"\n                item-value=\"id\"\n                :rules=\"[rules.required]\"\n              >\n              </v-select>\n            </v-col>\n          </v-row>\n\n          <v-row>\n            <v-col>\n              <v-select\n                label=\"Seleccione Código Organizador\"\n                v-model=\"codigo_productor.codigo_organizador_id\"\n                :items=\"codigo_organizadores\"\n                :item-text=\"codigoOrgText\"\n                item-value=\"id\"\n                :rules=\"[rules.required]\"\n              >\n              </v-select>\n            </v-col>\n          </v-row>\n\n          <v-row>\n            <v-col>\n              <v-text-field\n                v-uppercase\n                label=\"Codigo Productor\"\n                v-model=\"codigo_productor.codigo_productor\"\n                :rules=\"[\n                  rules.required,\n                  !cpUsado || 'Este codigo productor ya está en uso',\n                ]\"\n                @keyup=\"buscarCP\"\n              >\n              </v-text-field>\n            </v-col>\n            <v-col>\n              <v-switch\n                v-model=\"codigo_productor.activo\"\n                label=\"Codigo Productor Activo?\"\n              ></v-switch>\n            </v-col>\n          </v-row>\n        </v-form>\n      </v-container>\n    </v-card-text>\n    <v-card-actions class=\"d-flex justify-end\">\n      <v-btn\n        class=\"mb-2\"\n        color=\"red\"\n        text\n        @click=\"closeModal\"\n      >Cerrar</v-btn>\n      <v-btn\n        class=\"mb-2\"\n        v-if=\"!edicion2\"\n        color=\"green\"\n        @click=\"create\"\n        text\n        native-type=\"submit\"\n      >Crear</v-btn>\n      <v-btn\n        class=\"mb-2\"\n        v-else\n        @click=\"update\"\n        text\n        color=\"green\"\n      >Guardar</v-btn>\n    </v-card-actions>\n  </v-card>\n</template>\n\n<script>\nimport { mapState, mapActions, mapMutations } from \"vuex\";\nimport { helpers } from \"../../../../../helpers\";\nimport http from \"../../../../../http-request\";\nimport { debounce } from \"debounce\";\n\nexport default {\n  mixins: [helpers],\n  data: () => ({\n    rules: {\n      required: value => !!value || \"Este campo obligatorio\"\n    },\n    cpUsado: false\n  }),\n  computed: {\n    ...mapState(\"codigo_productor\", [\"codigo_productor\"]),\n    ...mapState(\"compania\", [\"compania\"]),\n    ...mapState(\"productor\", [\"productores\"]),\n    ...mapState(\"organizador\", [\"organizadores\"]),\n    ...mapState(\"codigo_organizador\", [\"codigo_organizadores\"]),\n    ...mapState(\"modal\", [\"modal2\", \"edicion2\"])\n  },\n  methods: {\n    ...mapActions(\"codigo_productor\", [\n      \"updateCodigoProductor\",\n      \"createCodigoProductor\"\n    ]),\n    ...mapMutations(\"modal\", [\"HIDE_MODAL2\"]),\n    ...mapMutations(\"codigo_productor\", [\"RESET_CODIGO_PRODUCTOR\"]),\n    async create() {\n      if (this.$refs.form.validate()) {\n        this.codigo_productor.compania_id = this.compania.id;\n        const createResult = await this.createCodigoProductor(\n          this.codigo_productor\n        );\n        if (createResult) {\n          this.closeModal();\n        }\n      }\n    },\n    async update() {\n      if (this.$refs.form.validate()) {\n        const updateResult = await this.updateCodigoProductor(\n          this.codigo_productor\n        );\n        if (updateResult) {\n          this.closeModal();\n        }\n      }\n    },\n    closeModal() {\n      this.HIDE_MODAL2(false);\n      this.RESET_CODIGO_PRODUCTOR();\n      this.$refs.form.resetValidation();\n      this.cpUsado = false;\n    },\n    buscarCP: debounce(async function() {\n      if (\n        this.codigo_productor.codigo_productor &&\n        this.codigo_productor.codigo_productor !=\n          this.codigo_productor.cpOriginal\n      ) {\n        const resp = await http.post(\"/codigo_productor/busquedaCP\", {\n          codigo_productor: this.codigo_productor.codigo_productor,\n          codigo_organizador_id: this.codigo_productor.codigo_organizador_id,\n          compania_id: this.compania.id\n        });\n        this.cpUsado = resp.data.usado;\n      }\n    }, 500)\n  },\n  watch: {\n    modal2() {\n      if (!this.modal2) {\n        this.closeModal();\n      }\n    }\n  }\n};\n</script>\n\n<style>\n</style>"]}]}