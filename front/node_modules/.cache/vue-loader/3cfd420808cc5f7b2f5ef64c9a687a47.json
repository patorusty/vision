{"remainingRequest":"/Users/patorusty/dev/web/vision/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/patorusty/dev/web/vision/front/src/views/pages/Configuracion/ModalUsuarios.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/patorusty/dev/web/vision/front/src/views/pages/Configuracion/ModalUsuarios.vue","mtime":1608263910095},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/patorusty/dev/web/vision/front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBodHRwIGZyb20gIi4uLy4uLy4uL2h0dHAtcmVxdWVzdCI7CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBBY3Rpb25zLCBtYXBNdXRhdGlvbnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IHsgZGVib3VuY2UgfSBmcm9tICJkZWJvdW5jZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogKCkgPT4gKHsKICAgIHVybDogInRpcG91c3VhcmlvIiwKICAgIGRpYWxvZzogZmFsc2UsCiAgICBtYWlsT3JpZ2luYWw6IG51bGwsCiAgICB0aXBvX3VzdWFyaW9zOiBbXSwKICAgIHRpcG9fdXN1YXJpbzogIiIsCiAgICBtYWlsVXNhZG86IGZhbHNlLAogICAgcnVsZXM6IHsKICAgICAgcmVxdWlyZWQ6IHZhbHVlID0+ICEhdmFsdWUgfHwgIkVzdGUgY2FtcG8gb2JsaWdhdG9yaW8iLAogICAgICBlbWFpbDogdmFsdWUgPT4gewogICAgICAgIGNvbnN0IHBhdHRlcm4gPSAvXigoW148PigpW1xdXFwuLDs6XHNAIl0rKFwuW148PigpW1xdXFwuLDs6XHNAIl0rKSopfCgiLisiKSlAKChcW1swLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31cLlswLTldezEsM31dKXwoKFthLXpBLVpcLTAtOV0rXC4pK1thLXpBLVpdezIsfSkpJC87CiAgICAgICAgcmV0dXJuIHBhdHRlcm4udGVzdCh2YWx1ZSkgfHwgIklncmVzZSB1biBlbWFpbCB2w6FsaWRvIjsKICAgICAgfQogICAgfQogIH0pLAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgidXN1YXJpb3MiLCBbInVzdWFyaW8iXSksCiAgICAuLi5tYXBTdGF0ZSgibW9kYWwiLCBbIm1vZGFsIiwgImVkaWNpb24iXSkKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoInVzdWFyaW9zIiwgWwogICAgICAiZ2V0VXN1YXJpbyIsCiAgICAgICJyZXNldFVzdWFyaW9TdGF0ZSIsCiAgICAgICJ1cGRhdGVVc3VhcmlvIiwKICAgICAgImNyZWF0ZVVzdWFyaW8iCiAgICBdKSwKICAgIC4uLm1hcE11dGF0aW9ucygibW9kYWwiLCBbIkhJREVfTU9EQUwiXSksCiAgICAuLi5tYXBNdXRhdGlvbnMoInVzdWFyaW9zIiwgWyJSRVNFVF9VU1VBUklPIl0pLAogICAgdXBkYXRlKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5mb3JtLnZhbGlkYXRlKCkpIHsKICAgICAgICB0aGlzLnVwZGF0ZVVzdWFyaW8odGhpcy51c3VhcmlvKTsKICAgICAgICB0aGlzLmNsb3NlTW9kYWwoKTsKICAgICAgfQogICAgfSwKICAgIGNyZWF0ZSgpIHsKICAgICAgaWYgKHRoaXMuJHJlZnMuZm9ybS52YWxpZGF0ZSgpKSB7CiAgICAgICAgdGhpcy51c3VhcmlvLnBhc3N3b3JkID0gIjEyMyI7CiAgICAgICAgdGhpcy5jcmVhdGVVc3VhcmlvKHRoaXMudXN1YXJpbyk7CiAgICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7CiAgICAgIH0KICAgIH0sCiAgICBjbG9zZU1vZGFsKCkgewogICAgICB0aGlzLkhJREVfTU9EQUwoZmFsc2UpOwogICAgICB0aGlzLlJFU0VUX1VTVUFSSU8oKTsKICAgICAgdGhpcy4kcmVmcy5mb3JtLnJlc2V0VmFsaWRhdGlvbigpOwogICAgICAgIHRoaXMubWFpbE9yaWdpbmFsID0gbnVsbDsKICAgICAgICB0aGlzLm1haWxVc2FkbyA9IGZhbHNlOwogICAgfSwKICAgIGNhcmdhclRpcG9fVXN1YXJpb3MoKSB7CiAgICAgIGh0dHAuZ2V0KHRoaXMudXJsKS50aGVuKHIgPT4gewogICAgICAgIHRoaXMudGlwb191c3VhcmlvcyA9IHIuZGF0YS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBjaGVja0VtYWlsOiBkZWJvdW5jZShhc3luYyBmdW5jdGlvbigpIHsKICAgICAgaWYgKAogICAgICAgIHRoaXMudXN1YXJpby5lbWFpbC5sZW5ndGggPj0gNiAmJgogICAgICAgIHRoaXMubWFpbE9yaWdpbmFsICE9IHRoaXMudXN1YXJpby5lbWFpbAogICAgICApIHsKICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgaHR0cC5wb3N0KCIvdXN1YXJpby9idXNxdWVkYU1haWwiLCB7CiAgICAgICAgICBlbWFpbDogdGhpcy51c3VhcmlvLmVtYWlsCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5tYWlsVXNhZG8gPSByZXNwLmRhdGEudXNhZG87CiAgICAgIH0KICAgIH0sIDcwMCkKICB9LAogIHdhdGNoOiB7CiAgICB1c3VhcmlvOiBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuZWRpY2lvbikgewogICAgICAgIHRoaXMubWFpbE9yaWdpbmFsID0gdGhpcy51c3VhcmlvLmVtYWlsOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5jYXJnYXJUaXBvX1VzdWFyaW9zKCk7CiAgfQp9Owo="},{"version":3,"sources":["ModalUsuarios.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuFA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ModalUsuarios.vue","sourceRoot":"src/views/pages/Configuracion","sourcesContent":["<template>\n  <v-card>\n    <v-card-title>\n      <span v-if=\"!edicion\" class=\"headline\">Crear Usuario</span>\n      <span v-else class=\"headline\">Editar Usuario</span>\n    </v-card-title>\n    <v-card-text>\n      <v-container>\n        <v-form ref=\"form\">\n          <v-row>\n            <v-col cols=\"12\" sm=\"6\" md=\"6\">\n              <v-text-field\n                label=\"Company\"\n                v-model=\"usuario.compania\"\n                :disabled=\"true\"\n              ></v-text-field>\n            </v-col>\n            <v-col cols=\"12\" sm=\"6\" md=\"6\">\n              <v-text-field\n                label=\"E-Mail\"\n                v-model=\"usuario.email\"\n                :rules=\"[\n                  rules.required,\n                  rules.email,\n                  !mailUsado || 'Este email ya está en uso'\n                ]\"\n                @keyup=\"checkEmail\"\n              ></v-text-field>\n            </v-col>\n            <v-col cols=\"6\">\n              <v-text-field\n                label=\"Nombre\"\n                v-model=\"usuario.nombre\"\n                :rules=\"[rules.required]\"\n              ></v-text-field>\n            </v-col>\n            <v-col cols=\"6\">\n              <v-text-field\n                label=\"Apellido\"\n                v-model=\"usuario.apellido\"\n                :rules=\"[rules.required]\"\n              ></v-text-field>\n            </v-col>\n            <v-col cols=\"12\" sm=\"4\">\n              <v-select\n                :items=\"tipo_usuarios\"\n                label=\"Tipo de Usuario\"\n                item-text=\"nombre\"\n                item-value=\"id\"\n                v-model=\"usuario.tipo_usuario_id\"\n              >\n              </v-select>\n            </v-col>\n            <v-col cols=\"12\" sm=\"4\">\n              <v-switch\n                class=\"ma-2\"\n                v-model=\"usuario.activo\"\n                label=\"Usuario Activo?\"\n              ></v-switch>\n            </v-col>\n            <v-col cols=\"12\" sm=\"4\">\n              <v-avatar color=\"red\">\n                <span class=\"white--text headline\">nombre</span>\n              </v-avatar>\n            </v-col>\n          </v-row>\n        </v-form>\n      </v-container>\n    </v-card-text>\n    <v-card-actions class=\"d-flex justify-end\">\n      <v-btn class=\"mb-2\" color=\"red\" text @click=\"closeModal\">Cerrar</v-btn>\n      <v-btn\n        class=\"mb-2\"\n        v-if=\"!edicion\"\n        color=\"green\"\n        @click=\"create\"\n        text\n        native-type=\"submit\"\n        >Crear</v-btn\n      >\n      <v-btn class=\"mb-2\" v-else @click=\"update\" text color=\"green\"\n        >Guardar</v-btn\n      >\n    </v-card-actions>\n  </v-card>\n</template>\n<script>\nimport http from \"../../../http-request\";\nimport { mapState, mapActions, mapMutations } from \"vuex\";\nimport { debounce } from \"debounce\";\n\nexport default {\n  data: () => ({\n    url: \"tipousuario\",\n    dialog: false,\n    mailOriginal: null,\n    tipo_usuarios: [],\n    tipo_usuario: \"\",\n    mailUsado: false,\n    rules: {\n      required: value => !!value || \"Este campo obligatorio\",\n      email: value => {\n        const pattern = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        return pattern.test(value) || \"Igrese un email válido\";\n      }\n    }\n  }),\n  computed: {\n    ...mapState(\"usuarios\", [\"usuario\"]),\n    ...mapState(\"modal\", [\"modal\", \"edicion\"])\n  },\n  methods: {\n    ...mapActions(\"usuarios\", [\n      \"getUsuario\",\n      \"resetUsuarioState\",\n      \"updateUsuario\",\n      \"createUsuario\"\n    ]),\n    ...mapMutations(\"modal\", [\"HIDE_MODAL\"]),\n    ...mapMutations(\"usuarios\", [\"RESET_USUARIO\"]),\n    update() {\n      if (this.$refs.form.validate()) {\n        this.updateUsuario(this.usuario);\n        this.closeModal();\n      }\n    },\n    create() {\n      if (this.$refs.form.validate()) {\n        this.usuario.password = \"123\";\n        this.createUsuario(this.usuario);\n        this.closeModal();\n      }\n    },\n    closeModal() {\n      this.HIDE_MODAL(false);\n      this.RESET_USUARIO();\n      this.$refs.form.resetValidation();\n        this.mailOriginal = null;\n        this.mailUsado = false;\n    },\n    cargarTipo_Usuarios() {\n      http.get(this.url).then(r => {\n        this.tipo_usuarios = r.data.data;\n      });\n    },\n    checkEmail: debounce(async function() {\n      if (\n        this.usuario.email.length >= 6 &&\n        this.mailOriginal != this.usuario.email\n      ) {\n        const resp = await http.post(\"/usuario/busquedaMail\", {\n          email: this.usuario.email\n        });\n        this.mailUsado = resp.data.usado;\n      }\n    }, 700)\n  },\n  watch: {\n    usuario: function() {\n      if (this.edicion) {\n        this.mailOriginal = this.usuario.email;\n      }\n    }\n  },\n  created() {\n    this.cargarTipo_Usuarios();\n  }\n};\n</script>\n"]}]}